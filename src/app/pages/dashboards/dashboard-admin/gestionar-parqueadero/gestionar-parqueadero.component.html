<section class="min-h-screen bg-gradient-to-br from-blue-50 to-cyan-50 p-8">

    <!-- Botón de regresar -->
    <div class="mb-6">
        <button routerLink="/dashboard/admin"
            class="shadow-md flex items-center gap-2 bg-blue-600 text-white px-5 py-2 rounded-xl font-medium hover:bg-blue-700 transition cursor-pointer">
            <i class="pi pi-arrow-left"></i>
            Regresar
        </button>
    </div>

    <h2 class="text-2xl font-bold text-blue-700 mb-6 text-center">Gestionar Parqueaderos</h2>

    <div class="w-full flex flex-col md:flex-row md:justify-between items-center gap-4 mb-6">
        <div class="sm:w-full md:w-1/2 flex flex-row gap-4">
            <input [(ngModel)]="placa" type="text" placeholder="Buscar placa..."
                class="w-full shadow-md bg-white border border-gray-300 rounded-xl px-4 py-2 focus:ring-2 focus:ring-blue-500 outline-none" />

            @if (cupoBuscado == null) {
                <button (click)="buscarVehiculo();"
                class="shadow-md bg-green-600 rounded-xl px-4 py-2 cursor-pointer hover:bg-green-700 transition">Buscar</button>
            } @else {
                <button (click)="limpiarBusqueda()"
                class="shadow-md bg-red-600 rounded-xl px-4 py-2 cursor-pointer hover:bg-red-700 transition">Limpiar</button>
            }

        </div>
        <select (change)="seleccionEstado($event);"
            class="w-full md:w-1/5 shadow-md bg-white cursor-pointer border border-gray-300 rounded-xl px-4 py-2 focus:ring-2 focus:ring-blue-500 outline-none">
            <option value="disponibles">Disponibles</option>
            <option selected value="ocupados">Ocupados</option>
        </select>
        <button
            class="w-full md:w-1/5 shadow-md bg-blue-600 text-white px-4 py-2 rounded-xl cursor-pointer hover:bg-blue-700 transition">
            + Nuevo Cupo
        </button>
    </div>

    @if (cuposOcupados) {
    <div class="bg-white rounded-2xl shadow-md overflow-hidden">
        <ul class="divide-y divide-gray-100">
            @for (cupo of cuposOcupados; track cupo.id) {
            <li class="p-5 flex justify-between items-center hover:bg-gray-50 transition">
                <div>
                    <h3 class="text-lg font-bold text-gray-800">Parqueadero Nº {{ cupo.id }} <strong [ngClass]="{
                            'text-red-600' : cupo.estadoDescripcion == 'Ocupado',
                            'text-yellow-600' : cupo.estadoDescripcion == 'Reservado'
                        }"> ({{ cupo.estadoDescripcion }}) </strong> </h3>
                    <div class="text-gray-600 text-sm flex flex-wrap gap-3">

                        @if (cupo.estadoDescripcion == 'Ocupado') {
                        <p><strong> <i class="pi pi-car"></i> Placa:</strong> {{ cupo.placa }}</p>
                        <p><strong> <i class="pi pi-calendar-clock"></i> Ingreso: </strong> {{ cupo.fechaIngresoReal |
                            date: 'dd/MM/YYYY hh:mm a' }} </p>
                        <p><strong> <i class="pi pi-clock"></i> Duración:</strong> {{ cupo.duracion }} H</p>
                        <p><strong>Costo Actual:</strong> {{ cupo.costo | currency:'COP $':'symbol':'1.2-2' }}</p>
                        }@else {
                        <p><strong> <i class="pi pi-car"></i> Placa:</strong> {{ cupo.placa }}</p>
                        <p><strong> <i class="pi pi-calendar-clock"></i> Ingreso E: </strong> {{
                            cupo.fechaIngresoEstipulada | date: 'dd/MM/YYYY hh:mm a' }} </p>
                        }

                    </div>
                </div>
                <div class="flex gap-3">

                    @if (cupo.estadoDescripcion == 'Ocupado') {
                    <button (click)="darSalida(cupo.id);"
                        class="text-red-600 font-semibold hover:underline cursor-pointer">
                        <i class="pi pi-sign-out"></i> Dar Salida
                    </button>
                    }@else {
                    <button (click)="darIngreso(cupo.id)"
                        class="text-blue-600 font-semibold hover:underline cursor-pointer">
                        <i class="pi pi-sign-in"></i> Dar Ingreso
                    </button>
                    }

                </div>
            </li>
            }
        </ul>
    </div>
    }

    @if (cuposDisponibles) {
    <div class="bg-white rounded-2xl shadow-md overflow-hidden">
        <ul class="divide-y divide-gray-100">
            @for (cupo of cuposDisponibles; track cupo.id) {
            <li class="p-5 flex justify-between items-center hover:bg-gray-50 transition">
                <div>
                    <h3 class="text-lg font-bold text-gray-800">Parqueadero Nº {{ cupo.id }} <strong
                            class="text-green-600">({{ cupo.estadoDescripcion }}) </strong> </h3>

                </div>
                <div class="flex gap-3">
                    <button routerLink="/dashboard/admin/ingreso"
                        class="text-blue-600 font-semibold hover:underline cursor-pointer">
                        <i class="pi pi-sign-in"></i> Dar Ingreso
                    </button>
                </div>
            </li>
            }
        </ul>
    </div>
    }

    @if (cupoBuscado) {
    <div class="bg-white rounded-2xl shadow-md overflow-hidden">
        <ul class="divide-y divide-gray-100">
            <li class="p-5 flex justify-between items-center hover:bg-gray-50 transition">
                <div>
                    <h3 class="text-lg font-bold text-gray-800">Parqueadero Nº {{ cupoBuscado.id }} <strong [ngClass]="{
                            'text-red-600' : cupoBuscado.estadoDescripcion == 'Ocupado',
                            'text-yellow-600' : cupoBuscado.estadoDescripcion == 'Reservado'
                        }"> ({{ cupoBuscado.estadoDescripcion }}) </strong> </h3>
                    <div class="text-gray-600 text-sm flex flex-wrap gap-3">

                        @if (cupoBuscado.estadoDescripcion == 'Ocupado') {
                        <p><strong> <i class="pi pi-car"></i> Placa:</strong> {{ cupoBuscado.placa }}</p>
                        <p><strong> <i class="pi pi-calendar-clock"></i> Ingreso: </strong> {{ cupoBuscado.fechaIngresoReal |
                            date: 'dd/MM/YYYY hh:mm a' }} </p>
                        <p><strong> <i class="pi pi-clock"></i> Duración:</strong> {{ cupoBuscado.duracion }} H</p>
                        <p><strong>Costo Actual:</strong> {{ cupoBuscado.costo | currency:'COP $':'symbol':'1.2-2' }}</p>
                        }@else {
                        <p><strong> <i class="pi pi-car"></i> Placa:</strong> {{ cupoBuscado.placa }}</p>
                        <p><strong> <i class="pi pi-calendar-clock"></i> Ingreso E: </strong> {{
                            cupoBuscado.fechaIngresoEstipulada | date: 'dd/MM/YYYY hh:mm a' }} </p>
                        }

                    </div>
                </div>
                <div class="flex gap-3">

                    @if (cupoBuscado.estadoDescripcion == 'Ocupado') {
                    <button (click)="darSalida(cupoBuscado.id);"
                        class="text-red-600 font-semibold hover:underline cursor-pointer">
                        <i class="pi pi-sign-out"></i> Dar Salida
                    </button>
                    }@else {
                    <button (click)="darIngreso(cupoBuscado.id)"
                        class="text-blue-600 font-semibold hover:underline cursor-pointer">
                        <i class="pi pi-sign-in"></i> Dar Ingreso
                    </button>
                    }

                </div>
            </li>
        </ul>
    </div>
    }
</section>